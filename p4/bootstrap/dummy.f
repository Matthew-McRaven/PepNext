: IF ' 0BRANCH , HERE@ 0 , ; [LATEST] IMMEDIATE

: THEN [LATEST] IMMEDIATE
    DUP
    HERE@ SWAP -
    SWAP !
;

: [COMPILE] [LATEST] IMMEDIATE
	WORD FIND >CWA ,
;

: ELSE [LATEST] IMMEDIATE
	' BRANCH ,
	HERE@ 0 ,
	SWAP
	[COMPILE] THEN
;

: BEGIN [LATEST] IMMEDIATE
    HERE@
;

: UNTIL [LATEST] IMMEDIATE
    ' 0BRANCH ,
    HERE@ - ,
;

: AGAIN [LATEST] IMMEDIATE
    ' BRANCH ,
    HERE@ - ,
;

: WHILE [LATEST] IMMEDIATE
    [COMPILE] IF
;

: REPEAT [LATEST] IMMEDIATE
    ' BRANCH ,
    SWAP HERE@ - ,
    DUP HERE@ SWAP -
    SWAP !
;
